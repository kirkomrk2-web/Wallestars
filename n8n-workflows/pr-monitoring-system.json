{
    "name": "PR Monitoring & Comment System",
    "nodes": [
        {
            "parameters": {
                "path": "pr-delegated",
                "responseMode": "responseNode",
                "options": {}
            },
            "id": "webhook-pr-delegated",
            "name": "Webhook: PR Delegated",
            "type": "n8n-nodes-base.webhook",
            "typeVersion": 1.1,
            "position": [
                250,
                300
            ],
            "webhookId": "pr-delegated-webhook"
        },
        {
            "parameters": {
                "path": "agent-status",
                "responseMode": "responseNode",
                "options": {}
            },
            "id": "webhook-agent-status",
            "name": "Webhook: Agent Status",
            "type": "n8n-nodes-base.webhook",
            "typeVersion": 1.1,
            "position": [
                250,
                500
            ],
            "webhookId": "agent-status-webhook"
        },
        {
            "parameters": {
                "path": "test-results",
                "responseMode": "responseNode",
                "options": {}
            },
            "id": "webhook-test-results",
            "name": "Webhook: Test Results",
            "type": "n8n-nodes-base.webhook",
            "typeVersion": 1.1,
            "position": [
                250,
                700
            ],
            "webhookId": "test-results-webhook"
        },
        {
            "parameters": {
                "resource": "issue",
                "operation": "createComment",
                "owner": "={{$json.owner || 'Wallesters-org'}}",
                "repository": "={{$json.repository || 'Wallestars'}}",
                "issueNumber": "={{$json.pr_number}}",
                "body": "=ü§ñ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**\\n\\n**–°—Ç–∞—Ç—É—Å:** PR –µ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω –∫—ä–º `{{$json.agent}}`\\n\\n**–û—á–∞–∫–≤–∞–Ω–∏ –¥–µ–π—Å—Ç–≤–∏—è:**\\n- Code review\\n- –¢–µ—Å—Ç–≤–∞–Ω–µ\\n- –û–¥–æ–±—Ä–µ–Ω–∏–µ\\n\\n**–í—Ä–µ–º–µ:** {{$json.timestamp}}\\n\\n---\\n_–ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–æ –æ—Ç n8n workflow_"
            },
            "id": "github-comment-delegated",
            "name": "GitHub: Comment on Delegated PR",
            "type": "n8n-nodes-base.github",
            "typeVersion": 1,
            "position": [
                450,
                300
            ],
            "credentials": {
                "githubApi": {
                    "id": "github-credentials",
                    "name": "GitHub API"
                }
            }
        },
        {
            "parameters": {
                "url": "={{$json.pr_url || $json.url}}",
                "method": "GET",
                "options": {}
            },
            "id": "check-pr-status",
            "name": "Check PR Status",
            "type": "n8n-nodes-base.httpRequest",
            "typeVersion": 4.1,
            "position": [
                650,
                300
            ]
        },
        {
            "parameters": {
                "conditions": {
                    "options": {
                        "caseSensitive": false,
                        "leftValue": "",
                        "typeValidation": "strict"
                    },
                    "conditions": [
                        {
                            "id": "condition-1",
                            "leftValue": "={{$json.state}}",
                            "rightValue": "open",
                            "operator": {
                                "type": "string",
                                "operation": "equals"
                            }
                        }
                    ],
                    "combinator": "and"
                },
                "options": {}
            },
            "id": "if-pr-open",
            "name": "IF: PR Open",
            "type": "n8n-nodes-base.if",
            "typeVersion": 2,
            "position": [
                850,
                300
            ]
        },
        {
            "parameters": {
                "resource": "issue",
                "operation": "createComment",
                "owner": "Wallesters-org",
                "repository": "Wallestars",
                "issueNumber": "={{$json.pr_number}}",
                "body": "=‚ö†Ô∏è **–ù–∞–ø–æ–º–Ω—è–Ω–µ –∑–∞ –ø—Ä–æ–≥—Ä–µ—Å**\\n\\n–ú–∏–Ω–∞—Ö–∞ 30 –º–∏–Ω—É—Ç–∏ –æ—Ç –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ—Ç–æ –Ω–∞ —Ç–æ–∑–∏ PR.\\n\\n**–ú–æ–ª—è –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞–π —Å—Ç–∞—Ç—É—Å–∞**\\n\\n---\\n_–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –Ω–∞–ø–æ–º–Ω—è–Ω–µ –æ—Ç n8n_"
            },
            "id": "github-reminder",
            "name": "GitHub: Send Reminder",
            "type": "n8n-nodes-base.github",
            "typeVersion": 1,
            "position": [
                1050,
                200
            ],
            "credentials": {
                "githubApi": {
                    "id": "github-credentials",
                    "name": "GitHub API"
                }
            }
        },
        {
            "parameters": {
                "unit": "minutes",
                "amount": 30
            },
            "id": "wait-30min",
            "name": "Wait 30 Minutes",
            "type": "n8n-nodes-base.wait",
            "typeVersion": 1.1,
            "position": [
                1050,
                300
            ],
            "webhookId": "wait-30min-webhook"
        },
        {
            "parameters": {
                "operation": "executeQuery",
                "query": "=INSERT INTO pr_tracking (pr_number, agent, status, delegated_at, repository)\\nVALUES ({{$json.pr_number}}, '{{$json.agent}}', 'delegated', NOW(), '{{$json.repository || 'Wallestars'}}')\\nON CONFLICT (pr_number) DO UPDATE SET\\n  agent = EXCLUDED.agent,\\n  status = EXCLUDED.status,\\n  last_updated = NOW();"
            },
            "id": "supabase-insert",
            "name": "Supabase: Track PR",
            "type": "n8n-nodes-base.postgres",
            "typeVersion": 2.4,
            "position": [
                450,
                400
            ],
            "credentials": {
                "postgres": {
                    "id": "supabase-credentials",
                    "name": "Supabase DB"
                }
            }
        },
        {
            "parameters": {
                "functionCode": "// –ê–Ω–∞–ª–∏–∑–∏—Ä–∞–π —Å—Ç–∞—Ç—É—Å –Ω–∞ –∞–≥–µ–Ω—Ç–∏—Ç–µ\\nconst agents = $json.agents;\\nconst alerts = [];\\n\\nfor (const [agentName, status] of Object.entries(agents)) {\\n  // –ü—Ä–æ–≤–µ—Ä–∏ –∑–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∏ –∞–≥–µ–Ω—Ç–∏\\n  if (!status.is_active && status.assigned_prs > 0) {\\n    alerts.push({\\n      agent: agentName,\\n      type: 'inactive',\\n      message: `–ê–≥–µ–Ω—Ç ${agentName} –µ –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω —Å ${status.assigned_prs} –Ω–∞–∑–Ω–∞—á–µ–Ω–∏ PR-–æ–≤–µ`,\\n      severity: 'warning'\\n    });\\n  }\\n  \\n  // –ü—Ä–æ–≤–µ—Ä–∏ –∑–∞ –ø—Ä–µ—Ç–æ–≤–∞—Ä–µ–Ω–∏ –∞–≥–µ–Ω—Ç–∏\\n  if (status.assigned_prs > 5) {\\n    alerts.push({\\n      agent: agentName,\\n      type: 'overloaded',\\n      message: `–ê–≥–µ–Ω—Ç ${agentName} –∏–º–∞ —Ç–≤—ä—Ä–¥–µ –º–Ω–æ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏ PR-–æ–≤–µ (${status.assigned_prs})`,\\n      severity: 'high'\\n    });\\n  }\\n}\\n\\nreturn alerts.map(alert => ({ json: alert }));"
            },
            "id": "analyze-agents",
            "name": "Code: Analyze Agent Status",
            "type": "n8n-nodes-base.code",
            "typeVersion": 2,
            "position": [
                450,
                500
            ]
        },
        {
            "parameters": {
                "conditions": {
                    "options": {
                        "caseSensitive": false,
                        "leftValue": "",
                        "typeValidation": "strict"
                    },
                    "conditions": [
                        {
                            "id": "condition-alert",
                            "leftValue": "={{$json.severity}}",
                            "rightValue": "high",
                            "operator": {
                                "type": "string",
                                "operation": "equals"
                            }
                        }
                    ],
                    "combinator": "or"
                },
                "options": {}
            },
            "id": "if-critical-alert",
            "name": "IF: Critical Alert",
            "type": "n8n-nodes-base.if",
            "typeVersion": 2,
            "position": [
                650,
                500
            ]
        },
        {
            "parameters": {
                "resource": "issue",
                "operation": "create",
                "owner": "Wallesters-org",
                "repository": "Wallestars",
                "title": "=üö® –ö—Ä–∏—Ç–∏—á–µ–Ω Alert: {{$json.agent}}",
                "body": "=**–¢–∏–ø:** {{$json.type}}\\n\\n**–°—ä–æ–±—â–µ–Ω–∏–µ:**\\n{{$json.message}}\\n\\n**Severity:** {{$json.severity}}\\n\\n**–í—Ä–µ–º–µ:** {{$now.toISO()}}\\n\\n---\\n_–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—ä–∑–¥–∞–¥–µ–Ω –æ—Ç n8n monitoring system_",
                "labels": "alert,automated,agent-monitoring"
            },
            "id": "github-create-alert-issue",
            "name": "GitHub: Create Alert Issue",
            "type": "n8n-nodes-base.github",
            "typeVersion": 1,
            "position": [
                850,
                450
            ],
            "credentials": {
                "githubApi": {
                    "id": "github-credentials",
                    "name": "GitHub API"
                }
            }
        },
        {
            "parameters": {
                "functionCode": "// –û–±—Ä–∞–±–æ—Ç–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏—Ç–µ –æ—Ç —Ç–µ—Å—Ç–æ–≤–µ—Ç–µ\\nconst testData = $json;\\n\\nconst summary = {\\n  workflow: testData.workflow,\\n  pr_number: testData.pr_number,\\n  timestamp: testData.timestamp,\\n  all_passed: testData.tests_passed === 'success' && \\n              testData.code_quality === 'success' && \\n              testData.security_scan === 'success' && \\n              testData.build_verification === 'success',\\n  results: {\\n    tests: testData.tests_passed,\\n    quality: testData.code_quality,\\n    security: testData.security_scan,\\n    build: testData.build_verification\\n  }\\n};\\n\\nconst emoji = summary.all_passed ? '‚úÖ' : '‚ùå';\\nconst status = summary.all_passed ? '–í—Å–∏—á–∫–∏ —Ç–µ—Å—Ç–æ–≤–µ –ø—Ä–µ–º–∏–Ω–∞—Ç–∏ —É—Å–ø–µ—à–Ω–æ' : '–ù—è–∫–æ–∏ —Ç–µ—Å—Ç–æ–≤–µ —Å–µ –ø—Ä–æ–≤–∞–ª–∏—Ö–∞';\\n\\nsummary.comment = `${emoji} **–†–µ–∑—É–ª—Ç–∞—Ç–∏ –æ—Ç —Ç–µ—Å—Ç–æ–≤–µ—Ç–µ**\\n\\n${status}\\n\\n**–î–µ—Ç–∞–π–ª–∏:**\\n- –¢–µ—Å—Ç–æ–≤–µ: ${testData.tests_passed === 'success' ? '‚úÖ' : '‚ùå'}\\n- Code Quality: ${testData.code_quality === 'success' ? '‚úÖ' : '‚ùå'}\\n- Security Scan: ${testData.security_scan === 'success' ? '‚úÖ' : '‚ùå'}\\n- Build: ${testData.build_verification === 'success' ? '‚úÖ' : '‚ùå'}\\n\\n**–í—Ä–µ–º–µ:** ${testData.timestamp}\\n\\n---\\n_–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–æ –æ—Ç n8n testing system_`;\\n\\nreturn { json: summary };"
            },
            "id": "process-test-results",
            "name": "Code: Process Test Results",
            "type": "n8n-nodes-base.code",
            "typeVersion": 2,
            "position": [
                450,
                700
            ]
        },
        {
            "parameters": {
                "resource": "issue",
                "operation": "createComment",
                "owner": "Wallesters-org",
                "repository": "Wallestars",
                "issueNumber": "={{$json.pr_number}}",
                "body": "={{$json.comment}}"
            },
            "id": "github-test-comment",
            "name": "GitHub: Post Test Results",
            "type": "n8n-nodes-base.github",
            "typeVersion": 1,
            "position": [
                650,
                700
            ],
            "credentials": {
                "githubApi": {
                    "id": "github-credentials",
                    "name": "GitHub API"
                }
            }
        },
        {
            "parameters": {
                "operation": "executeQuery",
                "query": "=INSERT INTO test_results (pr_number, workflow, all_passed, tests_passed, code_quality, security_scan, build_verification, timestamp)\\nVALUES ({{$json.pr_number}}, '{{$json.workflow}}', {{$json.all_passed}}, '{{$json.results.tests}}', '{{$json.results.quality}}', '{{$json.results.security}}', '{{$json.results.build}}', '{{$json.timestamp}}');"
            },
            "id": "supabase-test-results",
            "name": "Supabase: Store Test Results",
            "type": "n8n-nodes-base.postgres",
            "typeVersion": 2.4,
            "position": [
                850,
                700
            ],
            "credentials": {
                "postgres": {
                    "id": "supabase-credentials",
                    "name": "Supabase DB"
                }
            }
        },
        {
            "parameters": {
                "respondWith": "json",
                "responseBody": "={{ { \"status\": \"success\", \"message\": \"PR delegated webhook processed\" } }}"
            },
            "id": "respond-delegated",
            "name": "Respond: Delegated",
            "type": "n8n-nodes-base.respondToWebhook",
            "typeVersion": 1.1,
            "position": [
                1250,
                300
            ]
        },
        {
            "parameters": {
                "respondWith": "json",
                "responseBody": "={{ { \"status\": \"success\", \"message\": \"Agent status webhook processed\" } }}"
            },
            "id": "respond-status",
            "name": "Respond: Status",
            "type": "n8n-nodes-base.respondToWebhook",
            "typeVersion": 1.1,
            "position": [
                1050,
                500
            ]
        },
        {
            "parameters": {
                "respondWith": "json",
                "responseBody": "={{ { \"status\": \"success\", \"message\": \"Test results webhook processed\" } }}"
            },
            "id": "respond-tests",
            "name": "Respond: Tests",
            "type": "n8n-nodes-base.respondToWebhook",
            "typeVersion": 1.1,
            "position": [
                1050,
                700
            ]
        }
    ],
    "connections": {
        "Webhook: PR Delegated": {
            "main": [
                [
                    {
                        "node": "GitHub: Comment on Delegated PR",
                        "type": "main",
                        "index": 0
                    },
                    {
                        "node": "Supabase: Track PR",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "GitHub: Comment on Delegated PR": {
            "main": [
                [
                    {
                        "node": "Check PR Status",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Check PR Status": {
            "main": [
                [
                    {
                        "node": "IF: PR Open",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "IF: PR Open": {
            "main": [
                [
                    {
                        "node": "Wait 30 Minutes",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Wait 30 Minutes": {
            "main": [
                [
                    {
                        "node": "GitHub: Send Reminder",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "GitHub: Send Reminder": {
            "main": [
                [
                    {
                        "node": "Respond: Delegated",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Webhook: Agent Status": {
            "main": [
                [
                    {
                        "node": "Code: Analyze Agent Status",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Code: Analyze Agent Status": {
            "main": [
                [
                    {
                        "node": "IF: Critical Alert",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "IF: Critical Alert": {
            "main": [
                [
                    {
                        "node": "GitHub: Create Alert Issue",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "GitHub: Create Alert Issue": {
            "main": [
                [
                    {
                        "node": "Respond: Status",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Webhook: Test Results": {
            "main": [
                [
                    {
                        "node": "Code: Process Test Results",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Code: Process Test Results": {
            "main": [
                [
                    {
                        "node": "GitHub: Post Test Results",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "GitHub: Post Test Results": {
            "main": [
                [
                    {
                        "node": "Supabase: Store Test Results",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Supabase: Store Test Results": {
            "main": [
                [
                    {
                        "node": "Respond: Tests",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        }
    },
    "pinData": {},
    "settings": {
        "executionOrder": "v1",
        "saveManualExecutions": true,
        "callerPolicy": "workflowsFromSameOwner",
        "errorWorkflow": ""
    },
    "staticData": null,
    "tags": [],
    "triggerCount": 3,
    "updatedAt": "2026-01-12T05:33:00.000Z",
    "versionId": "1"
}